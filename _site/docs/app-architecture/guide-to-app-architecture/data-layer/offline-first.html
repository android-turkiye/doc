<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Offline first | Türkçe Android Dokümantasyonu</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="Offline first" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Android Dokümantasyonu Türkçe Çeviri Projesi" /> <meta property="og:description" content="Android Dokümantasyonu Türkçe Çeviri Projesi" /> <link rel="canonical" href="http://localhost:4000/docs/app-architecture/guide-to-app-architecture/data-layer/offline-first.html" /> <meta property="og:url" content="http://localhost:4000/docs/app-architecture/guide-to-app-architecture/data-layer/offline-first.html" /> <meta property="og:site_name" content="Türkçe Android Dokümantasyonu" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Offline first" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Android Dokümantasyonu Türkçe Çeviri Projesi","headline":"Offline first","url":"http://localhost:4000/docs/app-architecture/guide-to-app-architecture/data-layer/offline-first.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> Türkçe Android Dokümantasyonu </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Ana Sayfa</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in App basics category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/app-basics" class="nav-list-link">App basics</a><ul class="nav-list"><li class="nav-list-item "><a href="/docs/app-basics/build-your-first-app.html" class="nav-list-link">Build Your First App</a></li><li class="nav-list-item "><a href="/docs/app-basics/app-fundamentals.html" class="nav-list-link">App fundamentals</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in App resources category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/app-basics/app-resources/app-resources.html" class="nav-list-link">App resources</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/app-basics/app-resources/about-app-resources.html" class="nav-list-link">About app resources</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-resources/handle-configuration-changes.html" class="nav-list-link">Handle configuration changes</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-resources/localization/localization.html" class="nav-list-link">Localization</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-resources/complex-xml-resources.html" class="nav-list-link">Complex XML resources</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-resources/resource-types/resource-types.html" class="nav-list-link">Resource types</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in App manifest file category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/app-basics/app-manifest-file/app-manifest-file.html" class="nav-list-link">App manifest file</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/about-app-manifests.html" class="nav-list-link">About app manifests</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/action.html" class="nav-list-link">action</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/activity.html" class="nav-list-link">activity</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/activity-alias.html" class="nav-list-link">action</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/application.html" class="nav-list-link">application</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/category.html" class="nav-list-link">category</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/compatible-screens.html" class="nav-list-link">action</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/data.html" class="nav-list-link">data</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/grant-uri-permission.html" class="nav-list-link">grant-uri-permission</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/instrumentation.html" class="nav-list-link">instrumentation</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/intent-filter.html" class="nav-list-link">intent-filter</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/layout.html" class="nav-list-link">layout</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/manifest.html" class="nav-list-link">manifest</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/meta-data.html" class="nav-list-link">meta-data</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/path-permission.html" class="nav-list-link">path-permission</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/permission.html" class="nav-list-link">permission</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/permission-group.html" class="nav-list-link">permission-group</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/permission-tree.html" class="nav-list-link">permission tree</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/property.html" class="nav-list-link">property</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/receiver.html" class="nav-list-link">receiver</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/service.html" class="nav-list-link">service</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/supports-gl-texture.html" class="nav-list-link">supports-gl-texture</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/supports-screens.html" class="nav-list-link">supports-screens</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/uses-configuration.html" class="nav-list-link">uses-configuration</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/uses-feature.html" class="nav-list-link">manifest</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/uses-library.html" class="nav-list-link">uses-library</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/uses-native-library.html" class="nav-list-link">uses-native-library</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/uses-permission.html" class="nav-list-link">uses-permission</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/uses-permission-sdk-23.html" class="nav-list-link">uses-permission-sdk-23</a> </li><li class="nav-list-item "> <a href="/docs/app-basics/app-manifest-file/uses-sdk.html" class="nav-list-link">uses-sdk</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in App architecture category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/app-architecture" class="nav-list-link">App architecture</a><ul class="nav-list"><li class="nav-list-item "><a href="/docs/app-architecture/introduction.html" class="nav-list-link">Introduction</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Guide to app architecture category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/app-architecture/guide-to-app-architecture/guide-to-app-architecture.html" class="nav-list-link">Guide to app architecture</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/app-architecture/guide-to-app-architecture/about-app-architecture.html" class="nav-list-link">About app architecture</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/guide-to-app-architecture/ui-layer/ui-layer.html" class="nav-list-link">Ui layer</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/guide-to-app-architecture/domain-layer.html" class="nav-list-link">Domain layer</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/guide-to-app-architecture/data-layer/data-layer.html" class="nav-list-link">Data layer</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/guide-to-app-architecture/architecture-recommendatios.html" class="nav-list-link">Architecture recommendations</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/guide-to-app-architecture/learning-pathway.html" class="nav-list-link">Learning pathway</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Modularization category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/app-architecture/modularization/modularization.html" class="nav-list-link">Modularization</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/app-architecture/modularization/about-modularization.html" class="nav-list-link">About modularization</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/modularization/common-patterns.html" class="nav-list-link">Common patterns</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/modularization/recipes.html" class="nav-list-link">Recipes</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Architecture components category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/app-architecture/architecture-components/architecture-components.html" class="nav-list-link">Architecture components</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/app-architecture/architecture-components/ui-layer-libraries/ui-layer-libraries.html" class="nav-list-link">UI layer libraries</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/architecture-components/data-layer-libraries/data-layer-libraries.html" class="nav-list-link">Data layer libraries</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in App entry points category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/app-architecture/app-entry-points/app-entry-points.html" class="nav-list-link">App entry points</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/app-architecture/app-entry-points/activities/activities.html" class="nav-list-link">Activities</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/app-entry-points/app-shortcuts/app-shortcuts.html" class="nav-list-link">App shortcuts</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in App navigation category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/app-architecture/app-navigation/app-navigation.html" class="nav-list-link">App navigation</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/app-architecture/app-navigation/principles-of-navigation.html" class="nav-list-link">Principles of navigation</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/app-navigation/design-for-different-form-factors.html" class="nav-list-link">Design for different form factors</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/app-navigation/handle-configuration-changes.html" class="nav-list-link">Handle configuration changes</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/app-navigation/navigation-component/navigation-component.html" class="nav-list-link">Navigation component</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/app-navigation/fragments/fragments.html" class="nav-list-link">Fragments</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/app-navigation/app-links/app-links.html" class="nav-list-link">App links</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/app-navigation/create-swipe-views-with-tabs-using-viewpager.html" class="nav-list-link">Create swipe views with tabs using ViewPager</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/app-navigation/create-swipe-views-with-tabs-using-viewpager2.html" class="nav-list-link">Create swipe views with tabs using ViewPager2</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/app-navigation/add-support-for-back-navigation/add-support-for-back-navigation.html" class="nav-list-link">Add support for back navigation</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Dependency Injection category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/app-architecture/dependency-injection/dependency-injection.html" class="nav-list-link">Dependency Injection</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/app-architecture/dependency-injection/about-dependency-injection.html" class="nav-list-link">About dependency injection</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/dependency-injection/manual-dependency-injection.html" class="nav-list-link">Manual dependency injection</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/dependency-injection/dependency-injetion-with-hilt.html" class="nav-list-link">Dependency injection with Hilt</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/dependency-injection/hilt-in-multi-module-apps.html" class="nav-list-link">Hilt in multi-module apps</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/dependency-injection/use-hilt-with-other-jetpack-libraries.html" class="nav-list-link">Use Hilt with other Jetpack libraries</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/dependency-injection/hilt-testing-guide.html" class="nav-list-link">Hilt testing guide</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/dependency-injection/hilt-and-dagger-annotations-cheat-sheet.html" class="nav-list-link">Hilt and Dagger annotations cheat sheet</a> </li><li class="nav-list-item "> <a href="/docs/app-architecture/dependency-injection/dagger/dagger.html" class="nav-list-link">Dagger</a> </li></ul></li><li class="nav-list-item "><a href="/docs/app-architecture/app-startup.html" class="nav-list-link">App startup</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Core topics category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/core-topics" class="nav-list-link">Core topics</a><ul class="nav-list"></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Best practices category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/best-practices" class="nav-list-link">Best practices</a><ul class="nav-list"></ul></li></ul> </nav> <footer class="site-footer"> </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Ara" aria-label="Ara" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Guide to app architecture</a></li> <li class="breadcrumb-nav-list-item"><a href="">Data layer</a></li> <li class="breadcrumb-nav-list-item"><span>Offline first</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h2 id="offline-first"> <a href="#offline-first" class="anchor-heading" aria-labelledby="offline-first"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Offline first </h2> <p>Çevrimdışı öncelikli(offline-first) bir uygulama, temel işlevselliğinin tamamını veya kritik bir alt kümesini internet erişimi olmadan gerçekleştirebilen bir uygulamadır. Yani, iş mantığının bir kısmını veya tamamını çevrimdışı olarak gerçekleştirebilir.</p> <p>Çevrimdışı öncelikli bir uygulama oluşturmaya yönelik hususlar, uygulama verilerine ve business logic’e erişim sunan <a href="about-the-data-layer">data katmanı</a>nda başlar. Uygulamanın bu verileri zaman zaman cihaz dışındaki kaynaklardan yenilemesi gerekebilir. Bunu yaparken, güncel kalmak için ağ kaynaklarını kullanması gerekebilir.</p> <p>Ağ kullanılabilirliği her zaman garanti edilmez. Cihazlarda genellikle ağ bağlantısının zayıf veya yavaş olduğu dönemler olabilir. Kullanıcılar aşağıdakilerle karşılaşabilir:</p> <ul> <li>Sınırlı internet bant genişliği</li> <li>Asansör veya tünelde olduğu gibi geçici bağlantı kesintileri.</li> <li>Ara sıra veri erişimi. Örneğin, yalnızca WiFi kullanan tabletler.</li> </ul> <p>Nedeni ne olursa olsun, bir uygulamanın bu koşullarda yeterli şekilde çalışması genellikle mümkündür. Uygulamanızın çevrimdışı olarak doğru şekilde çalıştığından emin olmak için aşağıdakileri yapabilmelidir:</p> <ul> <li>Güvenilir bir ağ bağlantısı olmadan kullanılabilirliğini sürdürme.</li> <li>İlk ağ çağrısının tamamlanmasını veya başarısız olmasını beklemek yerine kullanıcılara yerel verileri hemen sunun.</li> <li>Pil ve veri durumunun bilincinde olacak şekilde veri alın. Örneğin, yalnızca şarj olurken veya WiFi’da olduğu gibi en uygun koşullarda veri getirme talebinde bulunarak. Yukarıdaki kriterleri karşılayabilen bir uygulama genellikle çevrimdışı öncelikli uygulama(offline-first app) olarak adlandırılır.</li> </ul> <p><a href="https://youtu.be/jaZ2gLMGUsM">Create offline-first apps</a></p> <h3 id="design-an-offline-first-app"> <a href="#design-an-offline-first-app" class="anchor-heading" aria-labelledby="design-an-offline-first-app"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Design an offline-first app </h3> <p>Çevrimdışı öncelikli bir uygulama tasarlarken data katmanından ve uygulama verileri üzerinde gerçekleştirebileceğiniz iki ana işlemden başlamalısınız:</p> <ul> <li> <p>Reads: Kullanıcıya bilgi göstermek gibi uygulamanın diğer bölümleri tarafından kullanılmak üzere veri çekme.</p> </li> <li> <p>Writes: User input’u daha sonra kullanmak üzere kalıcı hale getirme.</p> </li> </ul> <p>Veri katmanındaki <a href="about-the-data-layer.md#data-layer-architecture">repository</a>‘ler, uygulama verilerini sağlamak için veri kaynaklarını birleştirmekten sorumludur. Çevrimdışı öncelikli bir uygulamada, en kritik görevlerini gerçekleştirmek için ağ erişimine ihtiyaç duymayan en az bir veri kaynağı olmalıdır. Bu kritik görevlerden biri de veri okumaktır.</p> <p><mark style="background-color: lightblue">Not: En azından, çevrimdışı öncelikli bir uygulama ağ erişimi olmadan okuma yapabilmelidir. </mark></p> <h3 id="model-data-in-an-offline-first-app"> <a href="#model-data-in-an-offline-first-app" class="anchor-heading" aria-labelledby="model-data-in-an-offline-first-app"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Model data in an offline-first app </h3> <p>Çevrimdışı öncelikli bir uygulama, ağ kaynaklarını kullanan her repository için en az 2 veri kaynağına sahiptir:</p> <ul> <li>Local veri kaynağı</li> <li>Network veri kaynağı</li> </ul> <p><img src="/assets/images/offline-first-img1.png" alt="An offline-first repository" /></p> <p><mark style="background-color: lightblue">Not: Çevrimdışı öncelikli bir uygulamada ağ erişimi olan bir repository her zaman lokal bir veri kaynağına sahip olmalıdır.</mark></p> <h3 id="the-local-data-source"> <a href="#the-local-data-source" class="anchor-heading" aria-labelledby="the-local-data-source"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The local data source </h3> <p>Lokal veri kaynağı, uygulama için standart haline gelmiş <a href="about-the-data-layer.md#source-of-truth">source of truth</a>‘tır. Uygulamanın daha yüksek katmanlarının okuduğu tüm verilerin özel kaynağı olmalıdır. Bu, bağlantı durumları arasında veri tutarlılığı sağlar. Lokal veri kaynağı genellikle diske kalıcı olarak aktarılan bir depolama alanı tarafından desteklenir. Verileri diske kalıcı hale getirmenin bazı yaygın yolları şunlardır:</p> <ul> <li><a href="/docs/core-topics/app-data-and-files/save-data-in-a-local-database/about-the-local-database">Room</a> gibi ilişkisel veritabanları gibi yapılandırılmış veri kaynakları.</li> <li>Yapılandırılmamış veri kaynakları. Örneğin, Datastore ile protocol buffers.</li> <li>Basit dosyalar</li> </ul> <h3 id="the-network-data-source"> <a href="#the-network-data-source" class="anchor-heading" aria-labelledby="the-network-data-source"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The network data source </h3> <p>Network veri kaynağı uygulamanın gerçek state’idir. Lokal veri kaynağı en iyi ihtimalle network veri kaynağı ile senkronize edilir. Bunun gerisinde de kalabilir, bu durumda uygulamanın tekrar çevrimiçi olduğunda güncellenmesi gerekir. Tersine, network veri kaynağı, bağlantı geri geldiğinde uygulama onu güncelleyene kadar lokal veri kaynağının gerisinde kalabilir. Uygulamanın domain ve UI katmanları asla network katmanı ile doğrudan bağlantı kurmamalıdır. Onunla iletişim kurmak ve lokal veri kaynağını güncellemek için onu kullanmak hosting repository’nin sorumluluğundadır.</p> <h3 id="exposing-resources"> <a href="#exposing-resources" class="anchor-heading" aria-labelledby="exposing-resources"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exposing resources </h3> <p>Lokal ve network veri kaynakları, uygulamanızın bunları nasıl okuyabileceği ve yazabileceği konusunda temel farklılıklar gösterebilir. Lokal bir veri kaynağını sorgulamak, SQL sorguları kullanmak gibi hızlı ve esnek olabilir. Buna karşılık, network veri kaynakları yavaş ve kısıtlı olabilir, örneğin RESTful kaynaklarına id ile artımlı olarak erişirken olduğu gibi. Sonuç olarak, her veri kaynağı genellikle sağladığı verilerin kendi temsiline ihtiyaç duyar. Bu nedenle lokal veri kaynağı ve network veri kaynağı kendi modellerine sahip olabilir.</p> <p>Aşağıdaki dizin yapısı bu kavramı görselleştirmektedir. AuthorEntity, uygulamanın lokal veritabanından okunan bir yazarın temsilidir ve NetworkAuthor, network üzerinden serileştirilen bir yazarın temsilidir:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>data/
├─ local/
│ ├─ entities/
│ │ ├─ AuthorEntity
│ ├─ dao/
│ ├─ NiADatabase
├─ network/
│ ├─ NiANetwork
│ ├─ models/
│ │ ├─ NetworkAuthor
├─ model/
│ ├─ Author
├─ repository/
</code></pre></div></div> <p>AuthorEntity ve NetworkAuthor’un ayrıntıları aşağıdaki gibidir:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Network representation of [Author]
 */</span>
<span class="nd">@Serializable</span>
<span class="kd">data class</span> <span class="nc">NetworkAuthor</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">id</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">name</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">imageUrl</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">twitter</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">mediumPage</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">bio</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
<span class="p">)</span>

<span class="cm">/**
 * Defines an author for either an [EpisodeEntity] or [NewsResourceEntity].
 * It has a many-to-many relationship with both entities
 */</span>
<span class="nd">@Entity</span><span class="p">(</span><span class="n">tableName</span> <span class="p">=</span> <span class="s">"authors"</span><span class="p">)</span>
<span class="kd">data class</span> <span class="nc">AuthorEntity</span><span class="p">(</span>
    <span class="nd">@PrimaryKey</span>
    <span class="kd">val</span> <span class="py">id</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">name</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="nd">@ColumnInfo</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"image_url"</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">imageUrl</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="nd">@ColumnInfo</span><span class="p">(</span><span class="n">defaultValue</span> <span class="p">=</span> <span class="s">""</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">twitter</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="nd">@ColumnInfo</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"medium_page"</span><span class="p">,</span> <span class="n">defaultValue</span> <span class="p">=</span> <span class="s">""</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">mediumPage</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="nd">@ColumnInfo</span><span class="p">(</span><span class="n">defaultValue</span> <span class="p">=</span> <span class="s">""</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">bio</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></div> <p>Hem AuthorEntity hem de NetworkAuthor’u veri katmanının içinde tutmak ve harici katmanların kullanması için üçüncü bir türü ortaya çıkarmak iyi bir pratiktir. Bu, harici katmanları, uygulamanın davranışını temelden değiştirmeyen lokal ve network veri kaynaklarındaki küçük değişikliklerden korur. Bu, aşağıdaki snippet’te gösterilmiştir:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * External data layer representation of a "Now in Android" Author
 */</span>
<span class="kd">data class</span> <span class="nc">Author</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">id</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">name</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">imageUrl</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">twitter</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">mediumPage</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="kd">val</span> <span class="py">bio</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></div> <p>Network modeli daha sonra bunu lokal modele dönüştürmek için bir extension metodu tanımlayabilir ve lokal model de benzer şekilde aşağıda gösterildiği gibi bunu harici temsile dönüştürmek için bir metoda sahiptir:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Converts the network model to the local model for persisting
 * by the local data source
 */</span>
<span class="k">fun</span> <span class="nc">NetworkAuthor</span><span class="p">.</span><span class="nf">asEntity</span><span class="p">()</span> <span class="p">=</span> <span class="nc">AuthorEntity</span><span class="p">(</span>
    <span class="n">id</span> <span class="p">=</span> <span class="n">id</span><span class="p">,</span>
    <span class="n">name</span> <span class="p">=</span> <span class="n">name</span><span class="p">,</span>
    <span class="n">imageUrl</span> <span class="p">=</span> <span class="n">imageUrl</span><span class="p">,</span>
    <span class="n">twitter</span> <span class="p">=</span> <span class="n">twitter</span><span class="p">,</span>
    <span class="n">mediumPage</span> <span class="p">=</span> <span class="n">mediumPage</span><span class="p">,</span>
    <span class="n">bio</span> <span class="p">=</span> <span class="n">bio</span><span class="p">,</span>
<span class="p">)</span>

<span class="cm">/**
 * Converts the local model to the external model for use
 * by layers external to the data layer
 */</span>
<span class="k">fun</span> <span class="nc">AuthorEntity</span><span class="p">.</span><span class="nf">asExternalModel</span><span class="p">()</span> <span class="p">=</span> <span class="nc">Author</span><span class="p">(</span>
    <span class="n">id</span> <span class="p">=</span> <span class="n">id</span><span class="p">,</span>
    <span class="n">name</span> <span class="p">=</span> <span class="n">name</span><span class="p">,</span>
    <span class="n">imageUrl</span> <span class="p">=</span> <span class="n">imageUrl</span><span class="p">,</span>
    <span class="n">twitter</span> <span class="p">=</span> <span class="n">twitter</span><span class="p">,</span>
    <span class="n">mediumPage</span> <span class="p">=</span> <span class="n">mediumPage</span><span class="p">,</span>
    <span class="n">bio</span> <span class="p">=</span> <span class="n">bio</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></div> <p><mark style="background-color: lightblue">Not: Yukarıdaki gibi mapper'lar genellikle farklı modüllerde tanımlanan modeller arasında eşleme yapar. Sonuç olarak, tightly coupled modüllerden kaçınmak için bu mapperlari kullanıldıkları modüllerde tanımlamak genellikle faydalıdır. Daha fazla ayrıntı için [modularization kılavuzu](/docs/app-architecture/modularization/common-patterns.md#module-to-module-communication)na bakın.</mark></p> <h3 id="reads"> <a href="#reads" class="anchor-heading" aria-labelledby="reads"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reads </h3> <p>Okumalar, çevrimdışı öncelikli bir uygulamada uygulama verileri üzerindeki temel işlemdir. Bu nedenle, uygulamanızın verileri okuyabildiğinden ve yeni veriler mevcut olur olmaz uygulamanın bunları görüntüleyebildiğinden emin olmalısınız. Bunu yapabilen bir uygulama reaktif bir uygulamadır çünkü okuma API’lerini observable tiplerle sunarlar.</p> <p>Aşağıdaki kod parçasında, OfflineFirstTopicRepository tüm okuma API’leri için Flow döndürür. Bu, network veri kaynağından güncellemeler aldığında okuyucularını güncellemesini sağlar. Başka bir deyişle, OfflineFirstTopicRepository’nin lokal veri kaynağı invalid edildiğinde değişiklikleri iletmesine olanak tanır. Bu nedenle, OfflineFirstTopicRepository’nin her okuyucusu, uygulamaya network bağlantısı yeniden sağlandığında tetiklenebilecek veri değişikliklerini ele almaya hazır olmalıdır. Ayrıca, OfflineFirstTopicRepository verileri doğrudan lokal veri kaynağından okur. Veri değişikliklerini okuyucularına ancak önce lokal veri kaynağını güncelleyerek bildirebilir.</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">OfflineFirstTopicsRepository</span><span class="p">(</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">topicDao</span><span class="p">:</span> <span class="nc">TopicDao</span><span class="p">,</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">network</span><span class="p">:</span> <span class="nc">NiaNetworkDataSource</span><span class="p">,</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">TopicsRepository</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">getTopicsStream</span><span class="p">():</span> <span class="nc">Flow</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">Topic</span><span class="p">&gt;&gt;</span> <span class="p">=</span>
        <span class="n">topicDao</span><span class="p">.</span><span class="nf">getTopicEntitiesStream</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="nc">TopicEntity</span><span class="o">::</span><span class="n">asExternalModel</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p><mark style="background-color: lightblue">Not: Çevrimdışı öncelikli bir uygulamada repository'lerden okuma işlemleri doğrudan lokal veri kaynağından okunmalıdır. Herhangi bir güncelleme önce lokal veri kaynağına yazılmalıdır ve lokal veri kaynağı observable olduğu için tüketicilerini güncelleyecektir.</mark></p> <h4 id="error-handling-strategies"> <a href="#error-handling-strategies" class="anchor-heading" aria-labelledby="error-handling-strategies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Error handling strategies </h4> <p>Çevrimdışı öncelikli uygulamalarda hataları ele almanın, oluşabilecekleri veri kaynaklarına bağlı olarak benzersiz yolları vardır. Aşağıdaki alt bölümlerde bu stratejiler özetlenmektedir.</p> <ul> <li>Local data source Lokal veri kaynağından okuma sırasında oluşan hatalar nadir olmalıdır. Okuyucuları hatalardan korumak için, okuyucunun veri topladığı Flow’larda catch operatörünü kullanın.</li> </ul> <p>Bir ViewModel’de <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.flow/catch.html">catch</a> operatörünün kullanımı aşağıdaki gibidir:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">AuthorViewModel</span><span class="p">(</span>
    <span class="n">authorsRepository</span><span class="p">:</span> <span class="nc">AuthorsRepository</span><span class="p">,</span>
    <span class="o">..</span><span class="p">.</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">private</span> <span class="kd">val</span> <span class="py">authorId</span><span class="p">:</span> <span class="nc">String</span> <span class="p">=</span> <span class="o">..</span><span class="p">.</span>

   <span class="c1">// Observe author information</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">authorStream</span><span class="p">:</span> <span class="nc">Flow</span><span class="p">&lt;</span><span class="nc">Author</span><span class="p">&gt;</span> <span class="p">=</span>
        <span class="n">authorsRepository</span><span class="p">.</span><span class="nf">getAuthorStream</span><span class="p">(</span>
            <span class="n">id</span> <span class="p">=</span> <span class="n">authorId</span>
        <span class="p">)</span>
        <span class="p">.</span><span class="k">catch</span> <span class="p">{</span> <span class="nf">emit</span><span class="p">(</span><span class="nc">Author</span><span class="p">.</span><span class="nf">empty</span><span class="p">())</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p><mark style="background-color: lightblue">Not: catch operatörü yalnızca exception'ın uygulamayı çökertmesini engeller, backing Flow yine de sonlanır. Exception'dan sonra flow'tan collecting'e devam etmek için [retry](https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.flow/retry.html) metodunu kullanın.</mark></p> <ul> <li>Network data source Bir network veri kaynağından veri okunurken hata oluşursa, uygulamanın veri getirmeyi yeniden denemek için bir heuristic yöntem kullanması gerekecektir. Yaygın heuristic yöntemler şunlardır: <ul> <li> <p>Exponential backoff</p> <p><a href="https://en.wikipedia.org/wiki/Exponential_backoff">Exponential backoff</a>‘ta uygulama, başarılı olana veya diğer koşullar durması gerektiğini belirleyene kadar artan zaman aralıklarıyla network veri kaynağından okumayı denemeye devam eder. <img src="/assets/images/offline-first-img2.png" alt="Reading data with exponential backoff" /></p> <p>Uygulamanın backing off yapmaya devam edip etmeyeceğini değerlendirmek için kriterler şunlardır:</p> <ul> <li>Network veri kaynağının belirttiği hata türü. Örneğin, bağlantı eksikliğini gösteren bir hata döndüren network çağrılarını yeniden denemelisiniz. Tersine, uygun kimlik bilgileri mevcut olana kadar yetkilendirilmemiş HTTP isteklerini yeniden denememelisiniz.</li> <li>İzin verilen maksimum yeniden deneme sayısı.</li> </ul> </li> <li> <p>Network connectivity monitoring Bu yaklaşımda, uygulama network veri kaynağına bağlanabileceğinden emin olana kadar okuma istekleri kuyruğa alınır. Bağlantı kurulduktan sonra okuma isteği kuyruktan çıkarılır, veri okunur ve lokal veri kaynağı güncellenir. Android’de bu kuyruk bir Room veritabanı ile tutulabilir ve WorkManager kullanılarak kalıcı iş olarak tüketilebilir.</p> <p><img src="/assets/images/offline-first-img3.png" alt="Reading queues with network monitoring" /></p> </li> </ul> </li> </ul> <h3 id="writes"> <a href="#writes" class="anchor-heading" aria-labelledby="writes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Writes </h3> <p>Çevrimdışı öncelikli bir uygulamada veri okumak için önerilen yol observable tipleri kullanmak olsa da, yazma API’leri için eşdeğer olan suspend fonksiyonları gibi asenkron API’lerdir. Bu, UI thread’inin engellenmesini önler ve çevrimdışı öncelikli uygulamalardaki yazma işlemleri bir network sınırını geçerken başarısız olabileceğinden hata ele almaya yardımcı olur.</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">UserDataRepository</span> <span class="p">{</span>
    <span class="cm">/**
     * Updates the bookmarked status for a news resource
     */</span>
    <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">updateNewsResourceBookmark</span><span class="p">(</span><span class="n">newsResourceId</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">bookmarked</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div> <p>Yukarıdaki kod parçasında, yukarıdaki metot askıya aldığı için tercih edilen asenkron API <a href="https://developer.android.com/kotlin/coroutines">Coroutines</a>‘tir.</p> <h4 id="write-strategies"> <a href="#write-strategies" class="anchor-heading" aria-labelledby="write-strategies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Write strategies </h4> <p>Çevrimdışı öncelikli uygulamalarda veri yazarken göz önünde bulundurulması gereken üç strateji vardır. Hangisini seçeceğiniz, yazılmakta olan veri türüne ve uygulamanın gereksinimlerine bağlıdır:</p> <ul> <li> <p>Online-only writes</p> <p>Verileri network sınırı boyunca yazmayı deneyin. Başarılı olursa, lokal veri kaynağını günceller, aksi takdirde bir exception atar ve uygun şekilde yanıt vermeyi çağırana bırakır.</p> <p><img src="/assets/images/offline-first-img4.png" alt="Online only writes" /><br /> Bu strateji genellikle neredeyse gerçek zamanlı olarak çevrimiçi gerçekleşmesi gereken yazma işlemleri için kullanılır. Örneğin, bir banka transferi. Yazma işlemleri başarısız olabileceğinden, genellikle kullanıcıya yazmanın başarısız olduğunu bildirmek veya kullanıcının ilk etapta veri yazmaya çalışmasını önlemek gerekir. Bu senaryolarda kullanabileceğiniz bazı stratejiler şunları içerebilir:</p> <ul> <li>Bir uygulama veri yazmak için internet erişimi gerektiriyorsa, kullanıcıya veri yazmasına izin veren bir UI sunmamayı veya en azından bunu devre dışı bırakmayı tercih edebilir.</li> <li>Kullanıcının çevrimdışı olduğunu bildirmek için kullanıcının reddedemeyeceği bir açılır mesaj veya geçici bir mesaj kullanabilirsiniz.</li> </ul> </li> <li> <p>Queued writes</p> <p>Yazmak istediğiniz bir nesne olduğunda, bunu bir kuyruğa ekleyin. Uygulama tekrar çevrimiçi olduğunda exponential back off ile kuyruğu tüketmeye devam edin. Android’de çevrimdışı bir kuyruğu tüketmek, genellikle WorkManager’a devredilen kalıcı bir iştir.</p> <p><img src="/assets/images/offline-first-img5.png" alt="Write queues with retries" /></p> <p>Bu yaklaşım aşağıdaki durumlarda iyi bir seçimdir:</p> <ul> <li>Verilerin ağa yazılması zorunlu değildir.</li> <li>İşlem zamana duyarlı değildir.</li> <li>İşlemin başarısız olması durumunda kullanıcının bilgilendirilmesi gerekli değildir.</li> </ul> <p>Bu yaklaşımın kullanım alanları arasında analytics eventlar ve loglama yer alır.</p> </li> <li> <p>Lazy writes</p> <p>Önce lokal veri kaynağına yazın, ardından en uygun zamanda network’e bildirmek için yazma işlemini kuyruğa alın. Uygulama tekrar çevrimiçi olduğunda network ve lokal veri kaynakları arasında çakışmalar olabileceğinden bu önemsiz bir işlem değildir. Çakışma çözümü ile ilgili bir sonraki bölümde daha fazla ayrıntı verilmektedir.</p> <p><img src="/assets/images/offline-first-img6.png" alt="Lazy writes" /></p> <p>Bu yaklaşım, veriler uygulama için kritik olduğunda doğru seçimdir. Örneğin, çevrimdışı öncelikli bir yapılacaklar listesi uygulamasında, veri kaybı riskini önlemek için kullanıcının çevrimdışı olarak eklediği tüm görevlerin lokal olarak saklanması çok önemlidir.</p> <p><mark style="background-color:lightblue">Not: Çevrimdışı öncelikli uygulamalarda veri yazmak, olası çakışmalar nedeniyle genellikle veri okumaktan daha fazla dikkat gerektirir. Çevrimdışı öncelikli uygulamaların çevrimdışı öncelikli olarak kabul edilmesi için çevrimdışıyken veri yazabilmesi gerekmez.</mark></p> </li> </ul> <h3 id="synchronization-and-conflict-resolution"> <a href="#synchronization-and-conflict-resolution" class="anchor-heading" aria-labelledby="synchronization-and-conflict-resolution"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Synchronization and conflict resolution </h3> <p>Çevrimdışı öncelikli bir uygulama bağlantısını geri yüklediğinde, lokal veri kaynağındaki verileri network veri kaynağındaki verilerle bağdaştırması gerekir. Bu işleme senkronizasyon denir. Bir uygulamanın network veri kaynağıyla senkronize olmasının iki ana yolu vardır: 1-Pull-based synchronization, 2-Push-based synchronization</p> <ul> <li>Pull-based synchronization</li> </ul> <p>Pull-based senkronizasyonda uygulama, talep üzerine en son uygulama verilerini okumak için network’e ulaşır. Bu yaklaşım için yaygın bir heuristic yontem, uygulamanın verileri yalnızca kullanıcıya sunmadan hemen önce aldığı navigation-based’dir.</p> <p>Bu yaklaşım, uygulamanın network bağlantısının olmadığı kısa veya ara dönemler beklediği durumlarda en iyi sonucu verir. Bunun nedeni, veri yenilemenin fırsatçı olması ve uzun süreli bağlantısızlık durumlarında kullanıcının eskimiş ya da boş bir önbellekle uygulama hedeflerini ziyaret etmeye çalışması olasılığının artmasıdır.</p> <p><img src="/assets/images/offline-first-img7.png" alt="Pull-based synchronization" /></p> <p>Belirli bir ekran için sonsuz kaydırma listesindeki öğeleri getirmek üzere sayfa token’larının kullanıldığı bir uygulama düşünün. Uygulama lazy bir şekilde networke ulaşabilir, verileri lokal veri kaynağında kalıcı hale getirebilir ve daha sonra bilgileri kullanıcıya geri sunmak için lokal veri kaynağından okuyabilir. Network bağlantısının olmadığı durumlarda, repository sadece lokal veri kaynağından veri talep edebilir. Bu, <a href="https://developer.android.com/topic/libraries/architecture/paging/v3-network-db">Jetpack Paging Library</a> tarafından <a href="https://developer.android.com/reference/kotlin/androidx/paging/RemoteMediator">RemoteMediator API</a>‘si ile kullanılan modeldir.</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">FeedRepository</span><span class="p">(</span><span class="o">..</span><span class="p">.)</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="nf">feedPagingSource</span><span class="p">():</span> <span class="nc">PagingSource</span><span class="p">&lt;</span><span class="nc">FeedItem</span><span class="p">&gt;</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">FeedViewModel</span><span class="p">(</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">repository</span><span class="p">:</span> <span class="nc">FeedRepository</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">pager</span> <span class="p">=</span> <span class="nc">Pager</span><span class="p">(</span>
        <span class="n">config</span> <span class="p">=</span> <span class="nc">PagingConfig</span><span class="p">(</span>
            <span class="n">pageSize</span> <span class="p">=</span> <span class="nc">NETWORK_PAGE_SIZE</span><span class="p">,</span>
            <span class="n">enablePlaceholders</span> <span class="p">=</span> <span class="k">false</span>
        <span class="p">),</span>
        <span class="n">remoteMediator</span> <span class="p">=</span> <span class="nc">FeedRemoteMediator</span><span class="p">(</span><span class="o">..</span><span class="p">.),</span>
        <span class="n">pagingSourceFactory</span> <span class="p">=</span> <span class="n">feedRepository</span><span class="o">::</span><span class="n">feedPagingSource</span>
    <span class="p">)</span>

    <span class="kd">val</span> <span class="py">feedPagingData</span> <span class="p">=</span> <span class="n">pager</span><span class="p">.</span><span class="n">flow</span>
<span class="p">}</span>
</code></pre></div></div> <p>Pull Based senkronizasyonun avantaj ve dezavantajları aşağıdaki tabloda özetlenmiştir:</p> <div class="table-wrapper"><table> <thead> <tr> <th>Avantaj</th> <th>Dezavantaj</th> </tr> </thead> <tbody> <tr> <td>Uygulaması nispeten kolay.</td> <td>Yoğun veri kullanımına yatkındır. Bunun nedeni, bir navigasyon hedefine tekrarlanan ziyaretlerin, değişmeyen bilgilerin gereksiz yere yeniden alınmasını tetiklemesidir. Bunu uygun önbellekleme ile azaltabilirsiniz. Bu, <a href="https://developer.android.com/reference/kotlin/androidx/paging/package-summary#(kotlinx.coroutines.flow.Flow).cachedIn(kotlinx.coroutines.CoroutineScope)">cachedIn</a> operatörü ile UI katmanında veya bir HTTP önbelleği ile network katmanında yapılabilir.</td> </tr> <tr> <td>İhtiyaç duyulmayan veriler asla getirilmeyecektir</td> <td>Çekilen modelin kendi kendine yeterli olması gerektiğinden ilişkisel verilerle iyi ölçeklenmez. Senkronize edilen model, kendisini doldurmak için getirilecek diğer modellere bağlıysa, daha önce bahsedilen yoğun veri kullanımı sorunu daha da önemli hale gelecektir. Ayrıca, üst modelin repository’leri ile iç içe geçmiş modelin repository’leri arasında bağımlılıklara neden olabilir.</td> </tr> </tbody> </table></div> <ul> <li>Push-based synchronization</li> </ul> <p>Push based senkronizasyonda, lokal veri kaynağı network veri kaynağının bir replika setini elinden geldiğince taklit etmeye çalışır. Bir baseline belirlemek için ilk başlangıçta proaktif olarak uygun miktarda veri çeker, daha sonra bu veriler eskidiğinde kendisini uyarması için sunucudan gelen bildirimlere güvenir.</p> <p><img src="/assets/images/offline-first-img8.png" alt="Push-based synchronization" /></p> <p>Eskimiş bildiriminin alınmasının ardından uygulama, yalnızca eskimiş olarak işaretlenen verileri güncellemek için network’e ulaşır. Bu iş, network veri kaynağına ulaşan ve lokal veri kaynağına getirilen verileri kalıcı hale getiren Repository’ye devredilir. Repository verilerini gözlemlenebilir tiplerle sunduğundan, okuyucular herhangi bir değişiklikten haberdar edilecektir.</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">UserDataRepository</span><span class="p">(</span><span class="o">..</span><span class="p">.)</span> <span class="p">{</span>

    <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">synchronize</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">userData</span> <span class="p">=</span> <span class="n">networkDataSource</span><span class="p">.</span><span class="nf">fetchUserData</span><span class="p">()</span>
        <span class="n">localDataSource</span><span class="p">.</span><span class="nf">saveUserData</span><span class="p">(</span><span class="n">userData</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Bu yaklaşımda, uygulama network veri kaynağına çok daha az bağımlıdır ve uzun süreler boyunca onsuz çalışabilir. Çevrimdışıyken hem okuma hem de yazma erişimi sunar çünkü lokal olarak network veri kaynağından en son bilgilere sahip olduğu varsayılır.</p> <p>Push based senkronizasyonun avantajları ve dezavantajları aşağıdaki tabloda özetlenmiştir:</p> <div class="table-wrapper"><table> <thead> <tr> <th>Avantaj</th> <th>Dezavantaj</th> </tr> </thead> <tbody> <tr> <td>Uygulama süresiz olarak çevrimdışı kalabilir.</td> <td>Çakışma çözümü için verilerin versiyonlanması önemsizdir.</td> </tr> <tr> <td>Minimum veri kullanımı. Uygulama yalnızca değişen verileri alır.</td> <td>Senkronizasyon sırasında yazma endişelerini dikkate almanız gerekir.</td> </tr> <tr> <td>İlişkisel veriler için iyi çalışır. Her repository yalnızca desteklediği model için veri getirmekten sorumludur.</td> <td>Network veri kaynağının senkronizasyonu desteklemesi gerekir.</td> </tr> </tbody> </table></div> <ul> <li>Hybrid synchronization</li> </ul> <p>Bazı uygulamalar, verilere bağlı olarak pull veya push based olan hibrit bir yaklaşım kullanır. Örneğin, bir sosyal medya uygulaması, akış güncellemelerinin yüksek sıklığı nedeniyle kullanıcının takip akışını talep üzerine almak için pull based senkronizasyon kullanabilir. Aynı uygulama, kullanıcı adı, profil resmi vb. dahil olmak üzere oturum açan kullanıcı hakkındaki veriler için push based senkronizasyonu kullanmayı tercih edebilir.</p> <p>Sonuç olarak, çevrimdışı öncelikli senkronizasyon seçimi ürün gereksinimlerine ve mevcut teknik altyapıya bağlıdır.</p> <p><mark style="background-color:lightblue">Not: Uygulamanızın senkronizasyon yöntemi, uygulamanızın ihtiyaçlarına ve lokal ve network veri kaynaklarını destekleyen altyapının kısıtlamalarına bağlıdır.</mark></p> <h3 id="conflict-resolution"> <a href="#conflict-resolution" class="anchor-heading" aria-labelledby="conflict-resolution"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Conflict resolution </h3> <p>Uygulama çevrimdışıyken lokal olarak network veri kaynağıyla uyumsuz veri yazıyorsa, senkronizasyon gerçekleşmeden önce çözmeniz gereken bir çakışma meydana gelmiştir.</p> <p>Çakışma çözümü genellikle versiyonlama gerektirir. Uygulamanın, değişikliklerin ne zaman gerçekleştiğini takip etmek için bazı kayıt tutma işlemleri yapması gerekecektir. Bu, meta verileri network veri kaynağına aktarmasını sağlar. Network veri kaynağı daha sonra source of truth sağlama sorumluluğuna sahiptir. Uygulamanın ihtiyaçlarına bağlı olarak çakışma çözümü için dikkate alınması gereken çok çeşitli stratejiler vardır. Mobil uygulamalar için yaygın bir yaklaşım “son yazan kazanır(last write wins) “dır.</p> <ul> <li>Last write wins</li> </ul> <p>Bu yaklaşımda, cihazlar network’e yazdıkları verilere zaman damgası metadatası eklerler. Network veri kaynağı bunları aldığında, mevcut state’inden daha yeni olanları kabul ederken mevcut state’inden daha eski olan verileri reddeder.</p> <p><img src="/assets/images/offline-first-img9.png" alt="Last write wins" /></p> <p>Yukarıdaki şekilde, her iki cihaz da çevrimdışıdır ve başlangıçta network veri kaynağı ile senkronizedir. Çevrimdışıyken, her ikisi de lokal olarak veri yazar ve verilerini yazdıkları zamanı takip ederler. Her ikisi de tekrar çevrimiçi olduğunda ve network veri kaynağı ile senkronize edildiğinde, network, B cihazının verilerini daha sonra yazdığı için bu cihazın verilerini kalıcı hale getirerek çakışmayı çözer.</p> <h3 id="workmanager-in-offline-first-apps"> <a href="#workmanager-in-offline-first-apps" class="anchor-heading" aria-labelledby="workmanager-in-offline-first-apps"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> WorkManager in offline-first apps </h3> <p>Yukarıda ele alınan okuma ve yazma stratejilerinin her ikisinde de iki ortak araç vardı:</p> <ul> <li>Queues <ul> <li>Reads: Network bağlantısı mevcut olana kadar okumaları ertelemek için kullanılır.</li> <li>Writes: Network bağlantısı mevcut olana kadar yazmaları ertelemek ve yeniden denemeler için yazmaları yeniden istemek için kullanılır.</li> </ul> </li> <li>Network connectivity monitors <ul> <li>Reads: Uygulama bağlandığında okuma kuyruğunu boşaltmak ve senkronizasyon için bir sinyal olarak kullanılır</li> <li>Writes: Uygulama bağlandığında yazma kuyruğunu boşaltmak ve senkronizasyon için bir sinyal olarak kullanılır</li> </ul> </li> </ul> <p>Her iki durum da WorkManager’ın üstün olduğu <a href="/docs/app-architecture/architecture-components/data-layer-libraries/workmanager/about-workmanager.md#types-of-persistent-work">persistent work</a> örnekleridir. Örneğin <a href="https://github.com/android/nowinandroid">Now in Android</a> örnek uygulamasında, WorkManager lokal veri kaynağını senkronize ederken hem okuma kuyruğu hem de ağ monitörü olarak kullanılır. Başlangıçta, uygulama aşağıdaki eylemleri gerçekleştirir:</p> <ul> <li>Lokal veri kaynağı ile network veri kaynağı arasında eşitlik olduğundan emin olmak için okuma senkronizasyon işini kuyruga alın.</li> <li>Okuma senkronizasyon kuyruğunu boşaltın ve uygulama çevrimiçi olduğunda senkronize etmeye başlayın.</li> <li>Network veri kaynağından exponential backoff kullanarak bir okuma gerçekleştirin.</li> <li>Okuma sonuçlarını, oluşabilecek çakışmaları çözerek yerel veri kaynağına aktarın.</li> <li> <p>Lokal veri kaynağındaki verileri uygulamanın diğer katmanlarının kullanması için sunun.</p> </li> <li>Yukarıda anlatılanlar aşağıdaki şemada gösterilmiştir:</li> </ul> <p><img src="/assets/images/offline-first-img10.png" alt="Data synchronization in the Now in Android app" /></p> <p>WorkManager ile senkronizasyon işinin kuyruğa alınması, KEEP <a href="https://developer.android.com/reference/androidx/work/ExistingWorkPolicy">ExistingWorkPolicy</a> ile benzersiz iş olarak belirtilerek takip edilir:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">SyncInitializer</span> <span class="p">:</span> <span class="nc">Initializer</span><span class="p">&lt;</span><span class="nc">Sync</span><span class="p">&gt;</span> <span class="p">{</span>
   <span class="k">override</span> <span class="k">fun</span> <span class="nf">create</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="nc">Context</span><span class="p">):</span> <span class="nc">Sync</span> <span class="p">{</span>
       <span class="nc">WorkManager</span><span class="p">.</span><span class="nf">getInstance</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="nf">apply</span> <span class="p">{</span>
           <span class="c1">// Queue sync on app startup and ensure only one</span>
           <span class="c1">// sync worker runs at any time</span>
           <span class="nf">enqueueUniqueWork</span><span class="p">(</span>
               <span class="nc">SyncWorkName</span><span class="p">,</span>
               <span class="nc">ExistingWorkPolicy</span><span class="p">.</span><span class="nc">KEEP</span><span class="p">,</span>
               <span class="nc">SyncWorker</span><span class="p">.</span><span class="nf">startUpSyncWork</span><span class="p">()</span>
           <span class="p">)</span>
       <span class="p">}</span>
       <span class="k">return</span> <span class="nc">Sync</span>
   <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div> <p><mark style="background-color: lightblue">Not: "Now in Android "deki okuma kuyruğu sadece enqueueUniqueWork API'si ile temsil edilebilecek kadar basittir. Kuyruğun boşaltılma sırası hakkında daha sıkı garantiler için, Room veya Datastore gibi bir veri kalıcılığı API'si ile daha sağlam bir kuyruk uygulamasının gerçekleştirilmesi gerekecektir. Daha sonra bu kuyruğu sırayla boşaltmak için bir Worker ayarlanabilir. </mark></p> <p>Burada SyncWorker.startupSyncWork() aşağıdaki gibi tanımlanır:</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="cm">/**
 Create a WorkRequest to call the SyncWorker using a DelegatingWorker.
 This allows for dependency injection into the SyncWorker in a different
 module than the app module without having to create a custom WorkManager
 configuration.
*/</span>
<span class="k">fun</span> <span class="nf">startUpSyncWork</span><span class="p">()</span> <span class="p">=</span> <span class="nc">OneTimeWorkRequestBuilder</span><span class="p">&lt;</span><span class="nc">DelegatingWorker</span><span class="p">&gt;()</span>
    <span class="c1">// Run sync as expedited work if the app is able to.</span>
    <span class="c1">// If not, it runs as regular work.</span>
   <span class="p">.</span><span class="nf">setExpedited</span><span class="p">(</span><span class="nc">OutOfQuotaPolicy</span><span class="p">.</span><span class="nc">RUN_AS_NON_EXPEDITED_WORK_REQUEST</span><span class="p">)</span>
   <span class="p">.</span><span class="nf">setConstraints</span><span class="p">(</span><span class="nc">SyncConstraints</span><span class="p">)</span>
    <span class="c1">// Delegate to the SyncWorker.</span>
   <span class="p">.</span><span class="nf">setInputData</span><span class="p">(</span><span class="nc">SyncWorker</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="nf">delegatedData</span><span class="p">())</span>
   <span class="p">.</span><span class="nf">build</span><span class="p">()</span>

<span class="kd">val</span> <span class="py">SyncConstraints</span>
   <span class="k">get</span><span class="p">()</span> <span class="p">=</span> <span class="nc">Constraints</span><span class="p">.</span><span class="nc">Builder</span><span class="p">()</span>
       <span class="p">.</span><span class="nf">setRequiredNetworkType</span><span class="p">(</span><span class="nc">NetworkType</span><span class="p">.</span><span class="nc">CONNECTED</span><span class="p">)</span>
       <span class="p">.</span><span class="nf">build</span><span class="p">()</span>

</code></pre></div></div> <p>Özellikle, SyncConstraints tarafından tanımlanan Kısıtlamalar(<a href="https://developer.android.com/reference/androidx/work/Constraints">Constraints</a>) <a href="https://developer.android.com/reference/androidx/work/NetworkType">NetworkType</a>‘ın NetworkType.CONNECTED olmasını gerektirir. Yani, çalışmadan önce network kullanılabilir olana kadar bekler.</p> <p>Network kullanılabilir olduğunda, <a href="https://developer.android.com/reference/androidx/work/Worker">Worker</a> uygun Repository instance’larına temsilci atayarak SyncWorkName tarafından belirtilen benzersiz iş kuyruğunu boşaltır. Senkronizasyon başarısız olursa doWork() metodu Result.retry() ile döner. WorkManager, exponential backoff ile senkronizasyonu otomatik olarak yeniden deneyecektir. Aksi takdirde, senkronizasyonu tamamlayarak Result.success() döndürür.</p> <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">SyncWorker</span><span class="p">(</span><span class="o">..</span><span class="p">.)</span> <span class="p">:</span> <span class="nc">CoroutineWorker</span><span class="p">(</span><span class="n">appContext</span><span class="p">,</span> <span class="n">workerParams</span><span class="p">),</span> <span class="nc">Synchronizer</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">doWork</span><span class="p">():</span> <span class="nc">Result</span> <span class="p">=</span> <span class="nf">withContext</span><span class="p">(</span><span class="n">ioDispatcher</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// First sync the repositories in parallel</span>
        <span class="kd">val</span> <span class="py">syncedSuccessfully</span> <span class="p">=</span> <span class="nf">awaitAll</span><span class="p">(</span>
            <span class="nf">async</span> <span class="p">{</span> <span class="n">topicRepository</span><span class="p">.</span><span class="nf">sync</span><span class="p">()</span> <span class="p">},</span>
            <span class="nf">async</span> <span class="p">{</span> <span class="n">authorsRepository</span><span class="p">.</span><span class="nf">sync</span><span class="p">()</span> <span class="p">},</span>
            <span class="nf">async</span> <span class="p">{</span> <span class="n">newsRepository</span><span class="p">.</span><span class="nf">sync</span><span class="p">()</span> <span class="p">},</span>
        <span class="p">).</span><span class="nf">all</span> <span class="p">{</span> <span class="n">it</span> <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">syncedSuccessfully</span><span class="p">)</span> <span class="nc">Result</span><span class="p">.</span><span class="nf">success</span><span class="p">()</span>
        <span class="k">else</span> <span class="nc">Result</span><span class="p">.</span><span class="nf">retry</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div> <h3 id="samples"> <a href="#samples" class="anchor-heading" aria-labelledby="samples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://developer.android.com/topic/architecture/data-layer/offline-first#samples">Samples</a> </h3> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
